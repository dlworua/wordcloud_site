# 보험 키워드 트렌드 분석 대시보드

Google Trends 기반 실시간 보험 키워드 검색 트렌드 분석 및 워드클라우드 생성 웹 애플리케이션

## 주요 기능

### 📊 실시간 트렌드 분석
- **Google Trends 연동**: pytrends 라이브러리를 사용한 실시간 검색 트렌드 데이터 수집
- **9개 보험 카테고리 분석**: 종신보험, 건강보험, 암보험, 치아보험, 실손보험, 연금보험, 저축보험, 어린이보험, 운전자보험
- **다양한 기간 선택**: 최근 1일, 7일, 1개월, 3개월, 12개월
- **카테고리별/키워드별 필터링**: 전체 보험 비교 또는 특정 보험의 하위 키워드 상세 분석

### 🔍 3가지 분석 뷰

1. **워드클라우드**
   - 검색량 기반 시각화
   - 한글 폰트 지원 (AppleSDGothicNeo)
   - 카테고리별 필터링 가능

2. **카테고리별 검색 트렌드**
   - 전체 선택: 9개 보험 카테고리 비교 (세로 막대)
   - 특정 보험 선택: 해당 보험의 하위 키워드 분석 (가로 막대, 선택된 항목 최상단 표시)
   - 실제 Google Trends 검색량 기반

3. **인기 키워드 TOP 20**
   - 개별 키워드의 실제 검색량 조회
   - 카테고리별 필터링 지원
   - 검색량 차이를 명확하게 보여주는 가로 막대 그래프

### ⚡ 성능 최적화
- **1시간 캐싱 시스템**: 동일 조건 재조회 시 즉시 응답
- **배치 처리**: 키워드를 5개씩 묶어서 API 호출 최소화
- **카테고리 레벨 최적화**: 워드클라우드는 카테고리 단위로 빠르게 생성
- **상세 분석**: TOP 20 키워드는 개별 검색량 정확히 측정

## 기술 스택

### Backend
- **Flask 3.0.0**: 웹 프레임워크
- **pytrends 4.9.2**: Google Trends API 클라이언트
- **pandas 2.1.4**: 데이터 처리 및 분석
- **wordcloud 1.9.3**: 워드클라우드 생성
- **matplotlib 3.8.2**: 이미지 렌더링 (Agg 백엔드)
- **numpy 1.26.2**: 수치 연산
- **Pillow 10.1.0**: 이미지 처리

### Frontend
- **Chart.js 4.4.0**: 인터랙티브 차트 생성
- **Vanilla JavaScript**: 프레임워크 없는 순수 JavaScript
- **HTML5/CSS3**: 반응형 디자인 (Glassmorphism UI)

## 설치 및 실행

### 1. 저장소 클론
```bash
git clone <repository-url>
cd wordcloud_site
```

### 2. 가상환경 생성 및 활성화
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 3. 의존성 설치
```bash
pip install -r requirements.txt
```

### 4. 서버 실행
```bash
python app.py
```

서버는 `http://localhost:5001`에서 실행됩니다.
(포트 5000은 macOS AirPlay가 사용하므로 5001 사용)

## 프로젝트 구조

```
wordcloud_site/
├── app.py                      # Flask 메인 애플리케이션
├── trends_analyzer.py          # Google Trends 데이터 분석 모듈
├── keywords_config.py          # 보험 키워드 설정
├── requirements.txt            # Python 의존성
├── templates/
│   ├── dashboard.html          # 메인 대시보드 (통합 UI)
│   ├── index.html             # 텍스트 워드클라우드 (레거시)
│   └── trends.html            # 트렌드 분석 (레거시)
└── README.md
```

## API 엔드포인트

### GET `/`
메인 대시보드 페이지 렌더링

### POST `/generate`
텍스트 기반 워드클라우드 생성 (레거시)

### GET `/api/trends/wordcloud`
Google Trends 데이터 기반 워드클라우드 이미지 생성

**Query Parameters:**
- `timeframe`: 분석 기간 (기본값: `today 3-m`)
- `category`: 특정 카테고리 필터 (선택사항)

**Response:** PNG 이미지

### GET `/api/trends/categories`
카테고리별 검색 트렌드 데이터

**Query Parameters:**
- `timeframe`: 분석 기간 (기본값: `today 3-m`)
- `category`: 특정 카테고리 선택 시 하위 키워드 분석

**Response:**
```json
{
  "종신보험": 45.2,
  "건강보험": 62.8,
  ...
}
```

### GET `/api/trends/top-keywords`
상위 인기 키워드 추출 (개별 검색량 기반)

**Query Parameters:**
- `n`: 키워드 개수 (기본값: 20)
- `timeframe`: 분석 기간 (기본값: `today 3-m`)
- `category`: 특정 카테고리 필터 (선택사항)

**Response:**
```json
[
  ["암보험", 78.5],
  ["실손보험", 65.3],
  ...
]
```

### GET `/api/trends/hourly`
시간대별 검색 트렌드 분석

**Query Parameters:**
- `keywords`: 쉼표로 구분된 키워드 리스트
- `days`: 분석할 일수 (기본값: 7)

### GET `/api/trends/weekly`
요일별 검색 트렌드 분석

**Query Parameters:**
- `keywords`: 쉼표로 구분된 키워드 리스트

## 주요 기능 상세

### 캐싱 시스템
- **캐시 유지 시간**: 1시간
- **캐시 키 생성**: MD5 해시 기반 고유 키
- **캐시 적용 범위**:
  - Google Trends API 호출 결과
  - 카테고리별 가중치
  - 상세 키워드 가중치

### 데이터 분석
1. **카테고리 레벨 분석** (`get_keyword_weights`):
   - 9개 카테고리명 직접 조회 (빠름)
   - 각 카테고리 검색량을 하위 키워드에 동일 적용
   - 워드클라우드 생성용

2. **키워드 레벨 분석** (`get_detailed_keyword_weights`):
   - 모든 키워드를 5개씩 배치로 개별 조회 (정확함)
   - 실제 검색량 차이 측정
   - TOP 20 키워드 차트용

### 보험 카테고리 및 키워드

9개 카테고리, 총 90개 키워드:

- **종신보험**: 종신, 사망, 유족, 위험보험료, 종신형, 평생, 해약환급금, 보험료납입, 보장기간, 최저보험료
- **단기납 종신**: 단기납, 납입기간, 완납, 일시납, 10년납, 20년납, 납입면제, 유지비용, 목돈, 현금흐름
- **건강보험**: 건강보험, 질병보험, 진단비, 입원비, 수술비, 통원치료, 실비보장, 갱신형, 비갱신형, 보험료인상
- **암보험**: 암보험, 암진단비, 일반암, 고액암, 유사암, 소액암, 재발암, 전이암, 표적항암, 방사선치료
- **치아보험**: 치아보험, 임플란트, 크라운, 브릿지, 스케일링, 보철치료, 발치, 치주질환, 치아우식증, 치과보장
- **실손보험**: 실손보험, 실손의료비, 급여, 비급여, 자기부담금, 공제금액, 도수치료, 체외충격파, MRI, 초음파
- **연금보험**: 연금보험, 연금수령, 즉시연금, 거치식연금, 종신연금, 확정연금, 연금개시, 연금전환, 세액공제, 연금소득세
- **저축보험**: 저축보험, 목돈마련, 만기환급금, 이자율, 복리효과, 중도인출, 적립식, 거치식, 비과세, 절세
- **어린이보험**: 어린이보험, 태아보험, 출생전가입, 선천이상, 신생아질환, 성장기질병, 학교생활, 교육자금, 만기환급형, 자녀보험
- **운전자보험**: 운전자보험, 교통사고, 대인배상, 대물배상, 자기신체사고, 무보험차상해, 벌금, 변호사선임, 형사합의금, 방어비용

## 알려진 이슈

### macOS 관련
- **matplotlib GUI 스레드 에러**: `matplotlib.use('Agg')` 설정으로 해결
- **포트 5000 충돌**: macOS AirPlay Receiver가 5000 사용, 5001로 변경

### Google Trends API 제한
- **429 Too Many Requests**: API 호출 제한 초과 시 발생
  - 해결책: 0.5초 딜레이 + 1시간 캐싱
  - 첫 로딩 시간: 약 5-10초 소요
  - 캐시 적중 시: 즉시 응답

## 브라우저 호환성

- Chrome/Edge: 완전 지원
- Firefox: 완전 지원
- Safari: 완전 지원
- IE11 이하: 미지원 (ES6+ 문법 사용)

## 라이선스

이 프로젝트는 교육 및 연구 목적으로 제작되었습니다.

## 기여

버그 리포트 및 기능 제안은 이슈 트래커를 통해 제출해 주세요.

## 개발 히스토리

### v1.0.0 (2025-12-11)
- 초기 릴리스
- Google Trends 연동 및 9개 보험 카테고리 분석
- 통합 대시보드 UI (Glassmorphism 디자인)
- 캐싱 시스템 및 성능 최적화
- 동적 차트 필터링 (카테고리/키워드 레벨)
- 개별 키워드 검색량 분석 (TOP 20)
- 선택된 카테고리 최상단 정렬
